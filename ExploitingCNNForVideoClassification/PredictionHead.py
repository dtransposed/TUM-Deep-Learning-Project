'''! party07 !'''

import torch
import torch.nn as nn

class ThreeLayerFCN(nn.Module):
    # Gets a pretrained CNN (Currently VGG) and cuts off the FC head
        
    def __init__(self, dim):
        
        super(ThreeLayerFCN, self).__init__()
        
        self.input_layer = nn.Linear(dim[0], dim[1], bias=True)
        
        self.relu = nn.ReLU()
        
        self.output_layer = nn.Linear(dim[1], dim[2], bias=True)
        
        self.softmax = nn.Softmax(dim=1)
        
            
        
    def forward(self, data):
        
        xout = self.input_layer(data)
        
        xout = self.relu(xout)
        
        xout = self.output_layer(xout)
        
        return self.softmax(xout)